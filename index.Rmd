---
title: "Gov 50 Final Project"
author: "Tosca Langbert"
description: "Who Becomes a Billionaire? Why?"
output:
  distill::distill_article:
    self_contained: false
---
```{r, echo=FALSE}
# Setup chunk
library(tidyverse)
library(dplyr)
library(ggplot2)
library(infer)
library(knitr)
library(broom)
library(modelsummary)
billionaires <- read.csv("Billionaires Statistics Dataset.csv")
```
## Introduction and Research Question

There is significant controversy regarding the intense accumulation of wealth by a handful of people worldwide. Of the nearly eight billion people alive today, only a few thousand are billionaires. In fact, over one half of adults in 2022 had net worths less than $1,000 USD. These adults possessed a meager share of the world's total private wealth: 1.2%. In contrast, 1.1% of adults worldwide were millionaires in 2022, controlling 45.8% of the world's total private wealth. Some sources predict that these trends will only become more aggravated during the next half-decade.

In this project, I take a look at the wealthiest slice of people: billionaires. The approximately 3,000 billionaires worldwide, as I can conservatively estimate using my dataset, commanded $12.2 trillion USD as a group in 2022.

Specifically, I am concerned with what differentiates the "nouveau riche" from billionaires who inherited their wealth. My research question is: to what extent does being self-made explain whether someone becomes a billionaire? Furthermore, are there more powerful explanatory variables related to being a billionaire, like their gender, age, or geographic location? Or are there more circumstantial characteristics accounting for their wealth, like their industry or the GDP of their country of origin?

I hypothesize that circumstances of birth (e.g. someone's gender, geographic location, or whether they inherited their wealth) will better explain who becomes a billionaire than whether they are self-made or even more "distant" variables, like their country of origin's tax rate or education rate. 

This research is important because it may better-inform both reader understanding and policy interventions regarding the worldwide concentration of wealth. For instance, what if such concentrated wealth remains so concentrated through inheritance, marriage, and divorce rather than entrepreneurship, education rates, or tax rates? If that's the case, then spreading the benefits of such concentrated wealth to the public would involve taxing those life events to some extent. In contrast, if wealth remains concentrated because those who make it big have benefited from living in a well-educated country or from specific tax advantages, that would direct policymakers to intervene elsewhere.  

## Data (Sources and Variables)
```{r, echo = FALSE}
# after install.packages("countrycode")
library(countrycode)

# Add continent variable
billionaires <- billionaires |>
  mutate(continent = countrycode(country, "country.name", "continent"))
```
The author of the original dataset, who published it to Kaggle for public use, cites Forbes and other financial publications as the sources for his dataset. A total of 2,640 billionaires worldwide are represented in this data.

In addition, I merged the dataset 'countrycode' so that I could create a variable representing the continent of the billionaire ('continent'), in the hopes of better understanding the geographical origins of concentrated wealth.

It is extremely important to note the experimental design of my analysis. Obviously, it is not possible to randomly assign whether an individual becomes a billionaire or not (there's no world in which researchers could ethically assign one identical twin to be adopted by a 'normal' family, and the other twin to be adopted by an extraordinarily wealthy family). 

However, we can see that there are still differences among billionaires themselves. Being a billionaire is an arbitrary cutoff point between $999,999,999 and $1,000,000,001 USD. 

The resulting data file for this study is `Billionaires Statistics Dataset.csv`, which I simplified to 'billionaires'. It contains the following 36 variables:

| Name           | Description                                               |
|:---------------|:----------------------------------------------------------|
| `rank`       | The ranking of the billionaire in terms of wealth.   |
| `finalWorth` | The final net worth of the billionaire in U.S. dollars.     |
| `category`   | The category or industry in which the billionaire's business operates.  |
| `personName`   | The full name of the billionaire. |
| `age` | The age of the billionaire. |
| `continent`  | Continent of origin of the billionaire. |
| `country` | The country in which the billionaire resides. |
| `city`    | The city in which the billionaire resides. |
| `source`   | The source of the billionaire's wealth. |
| `industries` | The industries associated with the billionaire's business interests.   |
| `countryOfCitizenship`   | The country of citizenship of the billionaire. |
| `organization`   | The name of the organization or company associated with the billionaire. |
| `selfMade`   | Indicates whether the billionaire is self-made (True/False). |
| `status`   | "D" represents self-made billionaires (Founders/Entrepreneurs) and "U" indicates inherited or unearned wealth. |
| `gender`   | The gender of the billionaire. |
| `birthDate`   | The birthdate of the billionaire. |
| `lastName`   | The last name of the billionaire. |
| `firstName`   | The first name of the billionaire. |
| `title`   | The title or honorific of the billionaire. |
| `date`   | The date of data collection. |
| `state`   | The state in which the billionaire resides. |
| `residenceStateRegion` | The region or state of residence of the billionaire. |
| `birthYear`   | The birth year of the billionaire. |
| `birthMonth`   | The birth month of the billionaire. |
| `birthDay`   | The birth day of the billionaire. |
| `cpi_country`   | Consumer Price Index (CPI) for the billionaire's country. |
| `cpi_change_country`   | CPI change for the billionaire's country. |
| `gdp_country`   | Gross Domestic Product (GDP) for the billionaire's country. |
| `gross_tertiary_education_enrollment`  | Enrollment in tertiary education in the billionaire's country. |
| `gross_primary_education_enrollment_country`   | Enrollment in primary education in the billionaire's country. |
| `life_expectancy_country`   | Life expectancy in the billionaire's country. |
| `tax_revenue_country_country`   | Tax revenue in the billionaire's country. |
| `total_tax_rate_country`   | Total tax rate in the billionaire's country. |
| `population_country`   | Population of the billionaire's country. |
| `latitude_country`   | Latitude coordinate of the billionaire's country. |
| `longitude_country`   | Longitude coordinate of the billionaire's country. |

```{r, echo = FALSE, print=FALSE}
# Calculate median final worth of the billionaires
median_finalWorth <- median(billionaires$finalWorth)
print(median_finalWorth)
mean_finalWorth <- mean(billionaires$finalWorth)
print(mean_finalWorth)

# Need to find a nice way to print this
billionaires_aggregate_wealth <- sum(billionaires$finalWorth)
cat(billionaires_aggregate_wealth)
```

```{r, echo=FALSE}
# Distribution of net worth
ggplot(data = billionaires,
       mapping = aes(x = finalWorth)) +
  geom_histogram(color = "tan1", fill = "lightblue1") +
  theme_minimal() +
  labs(title = "Frequency of Billionaire Net Worth",
       x = "Net Worth (in millions USD)",
       y = "Count") +
 # Adding a vertical line at Elon Musk's net worth ($180 billion!)
  geom_vline(xintercept = 180000, 
           linetype = "dashed", color = "darkgreen", 
           size = .2, alpha = 0.7) +
  # Adding a text label for Elon Musk's net worth
  annotate("text", x = 180000, y = 30, 
           label = "Elon Musk's Net Worth ($180b)", color = "darkgreen", 
           angle = 90, vjust = -1.5, size = 2, hjust = -0.5) +
  # Adding a vertical line at MacKenzie Scott's net worth ($24,400,000,000 billion!)
  geom_vline(xintercept = 24400, 
           linetype = "dashed", color = "darkgreen", 
           size = .2, alpha = 0.7) +
  # Adding a text label for MacKenzie Scott's net worth
  annotate("text", x = 24400, y = 30, 
           label = "MacKenzie Scott's Net Worth ($24.4b)", color = "darkgreen", 
           angle = 90, vjust = -1.5, size = 2, hjust = -0.5) +
  # Adding a vertical line at Jeff Bezos's net worth ($114,400,000,000 billion)
  geom_vline(xintercept = 114000, 
           linetype = "dashed", color = "darkgreen", 
           size = .2, alpha = 0.7) +
  # Adding a text label for Jeff Bezos's net worth
  annotate("text", x = 114000, y = 30, 
           label = "Jeff Bezos's Net Worth ($114b)", color = "darkgreen", size = 2, 
           angle = 90, vjust = -1.5, size = 2, hjust = -0.5) +
   # Adding a vertical line at the median
  geom_vline(xintercept = median_finalWorth, 
             linetype = "dashed", color = "darkred", 
             size = .2, alpha = 0.7) +
  # Adding a text label for the median
  annotate("text", x = median_finalWorth, y = 30, 
           label = "Median ($2.3b)", color = "darkred", size = 2, 
           angle = 90, vjust = 1.5, size = 2, hjust = -2) +
  # Adding a vertical line at the mean
  geom_vline(xintercept = mean_finalWorth, 
             linetype = "dashed", color = "darkred", 
             size = .2, alpha = 0.7) +
  # Adding a text label for the mean
  annotate("text", x = mean_finalWorth, y = 30, 
           label = "Mean ($4.6b)", color = "darkred", size = 2, 
           angle = 90, vjust = -1.5, size = 2, hjust = -2)
```
Above is a histogram visualizing the frequency of the main outcome of interest: the different net worths ('finalWorth') of the billionaires. To help contextualize the values, I added in the median net worth of all of the billionaires, as well as the individual net worths of MacKenzie Scott (Jeff Bezos' former wife), Jeff Bezos himself, and Elon Musk. 
The median net worth of all of the billionaires is approximately $2.3 billion.

## Results

In the data visualization below, I compare the net worths of self-made and non-self-made billionaires. Interestingly, there is a marked difference in their average net worths. The typical self-made billionaire can expect to have a net worth of approximately $505 million (USD) lower than their counterparts with inherited wealth.

```{r, echo=FALSE}
ggplot(data = billionaires, 
       aes(x = selfMade, 
           y = finalWorth, 
           fill = selfMade)) +
  geom_boxplot() +
  scale_y_log10(labels = scales::dollar_format(prefix = "$")) +  # Change scale of y axis w/ help of GPT <3 
  labs(x = "Self-Made Status", 
       y = "Net Worth (in millions of dollars)", 
       title = "Comparing Billionaires' Net Worths by Self-Made Status", 
       fill = "Self-Made") +
  theme_linedraw() +
  scale_fill_manual(values = c("tan1", "lightblue1"))
```

```{r, echo=FALSE}
billionaires |>
  group_by(selfMade) |>
  summarize(mean(finalWorth), median(finalWorth), sd(finalWorth)) |>
  knitr::kable(digits = 2,
               col.names = c("Self-Made Status", 
                             "Average Net Worth (in millions USD)",
                             "Median Net Worth (in millions USD)",
                             "Net Worth Standard Dev."))
```

Things get more interesting when we bring gender into the equation. In the data visualization below, we see that male and female billionaires perform comparatively well with one another. Although the average net worth of female billionaires trails that of their male counterparts by approximately $61 million USD, their median net worth is actually $200 million USD higher. 

```{r, echo = FALSE}
ggplot(data = billionaires, 
       aes(x = gender, 
           y = finalWorth, 
           fill = selfMade)) +
  geom_boxplot() +
  scale_y_log10(labels = scales::dollar_format(prefix = "$")) +  # Change scale of y axis w/ help of GPT <3 
  labs(x = "Gender", 
       y = "Net Worth (in millions of dollars)", 
       title = "Comparing the Net Worth of Billionaires by Gender and Self-Made Status", 
       fill = "Self-Made") +
  scale_x_discrete(labels = c("Female", "Male")) +
  theme_linedraw() +
  scale_fill_manual(values = c("tan1", "lightblue1"))
```
```{r, echo=FALSE}
billionaires |>
  group_by(gender) |>
  summarize(mean(finalWorth), median(finalWorth), sd(finalWorth)) |>
  knitr::kable(digits = 2,
               col.names = c("Gender", 
                             "Average Net Worth (in millions USD)",
                             "Median Net Worth (in millions USD)",
                             "Net Worth Standard Dev.")) 
```

However, this picture is somewhat complicated by the fact that female billionaires are comparatively rare. In this dataset, fewer than 400 of the 2,640 recorded billionaires are female. Not only that, the majority of female billionaires inherited their wealth. This trend reverses for male billionaires, the majority of whom are self-made and did not inherit their wealth.

```{r, echo = FALSE}
billionaires |>
  ggplot(mapping = aes(x = gender, 
                       fill = selfMade)) +
  geom_bar(position = "dodge") +
  theme_minimal() +
  scale_fill_manual(values = c("tan1", "lightblue1")) +
  scale_x_discrete(labels = c("Female", "Male")) +
  labs(title = "Frequency of Billionaires by Gender and Self-Made Status",
       y = "Count",
       x = "Gender",
       fill = "Self-Made Status")
```

It is also interesting to take a look at the geographic trends of where billionaires are from. Interestingly, over one fourth of the world's billionaires are in the United States, which represents only about 4% of the world's population. Only China comes close, with 20% of the world's billionaires and 18% of the world's population. In short, Americans are extremely overrepresented in the population of billionaires worldwide. 

```{r, echo = FALSE}
# Determing top 14 countries with most billionaires
country_counts <- billionaires |>
  group_by(country) |>
  summarise(count = n())

sorted_countries <- country_counts[order(-country_counts$count), ]
top_14_countries <- head(sorted_countries, 14)
knitr::kable(top_14_countries,
             col.names = c("Country", "Count"))
```

```{r, echo = FALSE}
ggplot(data = billionaires, 
       aes(x = continent, 
           y = finalWorth, 
           fill = selfMade)) +
  geom_boxplot() +
  scale_y_log10(labels = scales::dollar_format(prefix = "$")) +  # Change scale of y axis w/ help of GPT <3 
  labs(x = "Self-Made Status", 
       y = "Net Worth (in millions of dollars)", 
       title = "Comparing Billionaires' Net Worths by Continent & Self-Made Status", 
       fill = "Self-Made") +
  theme_linedraw() +
  scale_fill_manual(values = c("tan1", "lightblue1"))
```

```{r, echo = FALSE}
ggplot(data = billionaires, 
       aes(x = reorder(industries, -finalWorth, FUN = median),
           y = finalWorth, 
           fill = selfMade)) +
  geom_boxplot() +
  scale_y_log10(labels = scales::dollar_format(prefix = "$")) +
  labs(x = "Industry of Billionaire", 
       y = "Net Worth of Billionaire (in millions of dollars)", 
       title = "Comparing Billionaire Net Worth by Industry & Self-Made Status", 
       fill = "Self-Made Status") +
  theme_linedraw() +
  theme(axis.text.x = element_text(angle=45, hjust = 1)) +
  scale_fill_manual(values = c("tan1", "lightblue1"))
```

```{r, echo = FALSE}
billionaires |>
  mutate(
    age_cohort = case_when(
      age < 20 ~ "Under 20",
      age >= 20 & age < 40 ~ "Between 20 and 39",
      age >= 40 & age < 60 ~ "Between 40 and 59",
      age >= 60 & age < 80 ~ "Between 60 and 79",
      age >= 80 ~ "Age 80 and Above",
    ), na.rm = TRUE) |>
  ggplot(mapping = aes(x = fct_reorder(age_cohort, age), 
                       fill = selfMade)) +
  geom_bar(position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_manual(values = c("tan1", "lightblue1")) +
  labs(title = "Frequency of Billionaires by Age Cohort and Self-Made Status",
       y = "Count",
       x = "Age Cohort",
       fill = "Self-Made Status")
```

## Running regressions with net worth and explanatory variables

```{r, echo=FALSE}
# Running a regression of net worth and handful of other variables ('fit_billionaire_multiple')
fit_billionaire_multiple <- lm(finalWorth ~ age + selfMade + gender +  gross_tertiary_education_enrollment + tax_revenue_country_country + population_country, data = billionaires)
modelsummary::modelsummary(fit_billionaire_multiple,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared",
                                       "adj.r.squared"))
glance(fit_billionaire_multiple)
```
```{r, echo=FALSE}
# Running a regression of net worth and age ('fit_billionaire_age')
fit_billionaire_age <- lm(finalWorth ~ age, data = billionaires)
modelsummary::modelsummary(fit_billionaire_age,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared",
                                       "adj.r.squared"))
glance(fit_billionaire_age)
```
```{r, echo=FALSE}
# Running a regression of net worth and self-made status ('fit_billionaire_selfMade')
fit_billionaire_selfMade <- lm(finalWorth ~ selfMade, data = billionaires)
modelsummary::modelsummary(fit_billionaire_selfMade,
                           statistic = c("s.e. = {std.error}",
                                         "p = {p.value}"),
                           gof_map = c("nobs", "r.squared",
                                       "adj.r.squared"))
glance(fit_billionaire_selfMade)
```
This is interesting because it indicates that although being self-made is more common, it's not statistically significant when it comes to net worth!

## Conclusion



## Bibliography (incomplete)
https://www.kaggle.com/datasets/nelgiriyewithana/billionaires-statistics-dataset
r package "countrycode"
https://worldpopulationreview.com
https://www.statista.com/statistics/203930/global-wealth-distribution-by-net-worth/
https://www.visualcapitalist.com/global-wealth-distribution/


```{r, echo = FALSE, eval = FALSE}
# Archive of data visualizations I didn't want to use




# Retiring this barplot of self-made status/gender/net worth because I don't want to use it anymore!
# ggplot(data = billionaires, 
#       aes(x = gender, 
#           y = finalWorth, 
#           fill = gender)) +
#  geom_boxplot() +
#  scale_y_log10(labels = scales::dollar_format(prefix = "$")) + 
#  labs(x = "Gender", 
#       y = "Net Worth (in millions of dollars)", 
#       title = "Comparing the Net Worth of Billionaires by Gender",
#       fill = "Gender") +
#  theme_linedraw() +
#  scale_fill_manual(values = c("pink1", "lightblue3")) +
#  scale_x_discrete(labels = c("Female", "Male"))
```

